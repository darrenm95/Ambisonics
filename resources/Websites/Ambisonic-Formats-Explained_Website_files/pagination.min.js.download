/*!
 * Squarespace Numbered Pagination - Give your Blogs a pagination
 * Author: Michael Mashay <michael@squarespacewebsites.com>
 * License: Commercial License
 * 21.07.2020
 */
!function(){var l={place:"append",backgroundColor:"transparent",align:"left",margin:"3% 0",padding:"0",showPrevNext:{next:"Next",prev:"Prev"},pagesRange:3,pagesAround:2,items:{style:"square",width:"32px",margin:"6px",backgroundColor:"#fff",activeBackgroundColor:"#555",color:"#000",activeColor:"#fff"}},n=".pagination-block-plugin .pagination-item.show-dot{margin:0 1px!important;pointer-events:none!important}.pagination-block-plugin .pagination-item.show-dot:not(.active) a{border:none!important;width:auto!important;background-color:transparent!important}.pagination-block-plugin:not(.showPrevNext) .arrow{display:none!important}.pagination-block-plugin{margin:3% 0;clear:both;box-sizing:border-box;display:inline-block;width:100%;grid-column-start: 1;grid-column-end: -1}.pagination-item a{border:none;display:block;white-space:nowrap;text-align:center;padding:0;margin:0;border-width:2px;border-style: solid;transition:all .1s linear;-webkit-transition:all .1s linear}.pagination-block-plugin.style-circle .pagination-item a{border-radius:50%}.pagination-block-plugin.style-pillow .pagination-item a{border-radius:4px}.pagination-block-plugin .pagination-item:first-child{margin-left:0}.pagination-block-plugin .pagination-item:last-child{margin-right:0}.pagination-block-plugin .pagination-item{display:inline-block;overflow:hidden;vertical-align:middle}",s=".pagination-block-{{guid}}{text-align: {{align}};margin:{{margin}};padding:{{padding}};background-color:{{backgroundColor}};}",c=".pagination-block-{{guid}} .pagination-item{padding-bottom:5px;margin: 0 {{margin}}}.pagination-block-{{guid}} .pagination-item a{border-color:{{color}};width:{{width}};line-height:{{width}};background-color:{{backgroundColor}};color:{{color}}}.pagination-block-plugin .pagination-item.active a,.pagination-block-plugin .pagination-item:hover a{background-color:{{activeBackgroundColor}};color:{{activeColor}};border-color:{{activeBackgroundColor}}}",g={enabled:!0,cacheTime:10,removeFields:"body,variants,excerpt"};function p(e,t){return e=e.replace(/{{(\w+)}}/g,function(e,n){return t&&t.hasOwnProperty(n)?t[n]:"auto"})}function d(e,n,t){var o;(t=t||window).document.getElementById(n)||((o=t.document.createElement("style")).type="text/css",o.id=n,o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.document.createTextNode(e)),t.document.querySelectorAll("body")[0].appendChild(o))}function x(e){var n,t,o=!1;return e.search&&(n=e.search.substring(1),o=JSON.parse('{"'+n.replace(/&/g,'","').replace(/=/g,'":"')+'"}',function(e,n){return n})),3<e.pathname.split("/").length&&("tag"==(t=e.pathname.split("/").slice(2))[0]?o={tag:t[1]}:"category"==t[0]&&(o={category:t[1]})),o}function u(n,e,t,o,i){function a(){var e=window.location.hostname.replace(/\./g,"-")+"_"+t+"_pagination-"+n;!function(n,t,o,e){try{var i=window.localStorage,a=t,r=(t=t.replace(/\//g,"")+"_json")+"_expires";if(e=e||10,n&&i){var l=(new Date).getTime()+6e4*e,s={};if((s=JSON.stringify(n)).length){-1<a.indexOf("/")&&i.getItem(a)&&i.removeItem(a);try{i.setItem(t,s)}catch(e){if(console.log(e.message||e),!o&&n&&n.items&&n.items.length)for(var c=n.items.length-1;0<=c;c--)n.items[c].body&&(n.items[c].body="y");s=JSON.stringify(n);try{i.setItem(t,s),console.log("Items body was reduced to fit localStorage quota")}catch(e){console.log(e.message||e,"Still too heavy collection to save local.")}}i.setItem(r,l)}}}catch(e){console.log(e)}}({saved:!0,minutes:o.cacheTime,timestamp:(new Date).getTime()},e,!0,o.cacheTime)}if(i)a();else{if(o&&o.removeFields&&o.removeFields.length&&(o.removeFields=(o.removeFields+"").split(","),e&&e.items&&e.items.length))for(var r=e.items.length-1;0<=r;r--){var l=e.items[r];e.items[r]={id:l.id,urlId:l.urlId}}var s={url:window.location.origin+"/pagination"+decodeURIComponent(n),content:e};Y.io("https://tools.squarewebsites.org/api/save-sqs-response/"+t+"/",{headers:{"Content-Type":"application/json;charset=UTF-8"},method:"POST",data:JSON.stringify(s),on:{success:function(e,n){n&&n.responseText&&(n=JSON.parse(n.responseText)).success&&n.file_saved&&a()},failure:function(e){console.log(e)}}})}}function m(e,n){return new Y.Promise(function(r){var l={items:[],collection:{},pageSize:10},s=null;e=e.split("?")[0];var c=P(n);!function o(i,a){var e={view:"list",format:"json",cache:((new Date).getTime()+"").substr(0,8)};a&&(e.offset=a),n.category&&(e.category=decodeURIComponent(n.category).replace(/\+/g," ")),n.tag&&(e.tag=decodeURIComponent(n.tag).replace(/\+/g," ")),n.month&&(e.month=n.month),Y.io(i,{data:e,on:{success:function(e,n){var t;try{(t=JSON.parse(n.responseText)).collection&&(l.collection=t.collection,s=t.collection.pageSize,l.pageSize=s),t.pagination&&t.pagination.pageSize&&(s=t.pagination.pageSize,l.pageSize=s),t.items&&t.items.length||t.upcoming&&t.upcoming.length||t.past&&t.past.length?(l.items=t.items?l.items.concat(t.items):l.items.concat(t.upcoming,t.past),t.pagination&&t.pagination.nextPage&&a!=t.pagination.nextPageOffset+""?o(i,t.pagination.nextPageOffset):(r({collection:t.collection,items:l.items,pageSize:s}),u(i+c,l,"json",g,!1))):(r({collection:t.collection,items:l.items,pageSize:s}),u(i+c,l,"json",g,!1))}catch(e){return console.log("JSON Parse failed!",e),!1}},failure:function(e){console.warn("error : "+e.message),r(l)}}})}(e)})}function f(a,e,r){return new Y.Promise(function(t,e){function o(){m(a,r).then(function(e){t(e)})}var n=P(r),i=function(e){try{var n=window.localStorage,t=(e=e.replace(/\//g,"")+"_json")+"_expires";if(!e||!n)return!1;try{var o=n.getItem(t);return!!o&&(!(parseInt(o)<(new Date).getTime())&&JSON.parse(n.getItem(e)))}catch(e){return console.log(e),!1}}catch(e){return console.log(e),!1}}(window.location.hostname.replace(/\./g,"-")+"_json_pagination-"+a.replace("/","")+n);(function(e,n,t,o){0==e.indexOf("/")&&(e=e.substr(1));var i,a="https://tools.squarewebsites.org/sqs-response/"+window.location.hostname.replace(/\./g,"-")+"/"+n+"/pagination-"+((i=decodeURIComponent(e))&&0==i.indexOf("/")&&(i=i.substr(1)),i.replace("?","--query--").replace(/[^A-Za-z0-9-]+/g,"-")||"-")+".json";return!t||!t.saved||t&&t.minutes&&t.minutes!=o.cacheTime||!o.cacheTime?a+="?ver="+(new Date).getTime():t&&t.timestamp&&(a+="?ver="+t.timestamp),new Y.Promise(function(t,e){Y.io(a,{headers:{"Content-Type":"application/json;charset=UTF-8"},on:{success:function(e,n){n&&n.responseText&&t(JSON.parse(n.responseText))},failure:function(){e("server")}}})})})(a+n,"json",i,g).then(function(e){var n=e.items&&e.items.length;resolved=!0,!(e.collection&&e.collection.fullUrl&&n)||i&&i.minutes&&i.minutes!=g.cacheTime||!g.cacheTime?o():t(e)}).catch(function(e){console.log(e),o()})})}function t(e,y){Y.one(e)&&(Y.all(e).each(function(e,n){var t,o,i=n+1,a=y.showPrevNext?" showPrevNext":"",h=Y.Node.create('<nav class="pagination-block pagination-block-'+i+" pagination-block-plugin clear"+a+'"></nav>'),w=location.pathname.split("/").slice(0,2).join("/");(y=function e(n,t){for(var o in t)t.hasOwnProperty(o)&&(n[o]&&"object"==typeof t[o]?e(n[o],t[o]):n[o]=t[o]);return n}(l,y))&&(y.guid=i,y.collectionUrl&&(w=y.collectionUrl),y.place&&"prepend"===y.place.trim()?e.prepend(h):e.append(h),y.items&&(y.items.guid=i,y.items.style&&h.addClass("style-"+y.items.style),t=parseFloat(y.items.margin.replace(/[^\d.-]/g,"")),o=y.items.margin.replace(/[\d.]/g,""),y.items.margin=0<t?t/2+o:0),d(p(s,y)+p(c,y.items),"paginationStylesPlugin-"+i));var v=x(window.location);((new Date).getTime()+"").substr(0,8);v&&v.page&&v.page;var b=P(v);var r=Y.one(".BlogList-pagination")||Y.one(".page.pagination")||Y.one(".blog-list .pagination")||Y.one(".blog-list-pagination");r&&r.hide();f(w,0,v).then(function(e){e&&e.collection?function(i){var e,n=i.pageSize||i.collection.pageSize||20,t=i.items?i.items&&i.items.length/n:v.category||v.tag||v.month?0:i.collection.itemCount/n,a=parseInt(t)+1,o=x(window.location),r=o&&o.page&&parseInt(o.page)||1;if(1<t){r&&1<r&&(e=y.showPrevNext&&y.showPrevNext.prev?y.showPrevNext.prev:"Prev",h.append('<div class="pagination-item arrow prev"><a style="border-radius:0;width:auto;padding:0 5px" data-ajax-loader="ajax-loader-binded" href="'+i.collection.fullUrl+"?page="+(r-1)+b+'">'+e+"</a></div>"));var l=!1;y.pagesRange&&3<=t/y.pagesRange&&(l=!0);for(var s,c=1;c<t+1;c++){var g="?page="+c+b.replace("?","&"),p="",d="",u="",m="";r!=c&&(r||1!==c)||(p=" active"),(c<r&&c>=r-y.pagesAround||r<c&&c<=r+y.pagesAround)&&r>=y.pagesRange&&(u=" around",c==r+y.pagesAround&&c>y.pagesRange&&c<a-y.pagesRange&&(u+=" last-around")),l&&(m=c===y.pagesRange?" before-next":c==a-y.pagesRange?" before-prev":"",c>y.pagesRange&&c<=a-y.pagesRange&&!u&&!p&&(d=" show-dot"));var f=d&&!p?".":c;h.append('<div class="pagination-item'+p+d+m+u+'" data-index="'+c+'"><a data-ajax-loader="ajax-loader-binded" href="'+i.collection.fullUrl+g+'">'+f+"</a></div>")}(!r||r<a)&&(s=y.showPrevNext&&y.showPrevNext.next?y.showPrevNext.next:"Next",h.append('<div class="pagination-item arrow next"><a style="border-radius:0;width:auto;padding:0 5px" data-ajax-loader="ajax-loader-binded" href="'+i.collection.fullUrl+"?page="+(r+1)+b.replace("?","&")+'">'+s+"</a></div>")),Y.io(w+"?page="+a+"&format=main-content"+b.replace("?","&"),{on:{success:function(e,n){var t,o;-1===n.responseText.indexOf("<article")?((t=h.one('.pagination-item[data-index="'+a+'"]'))&&t.remove(),(o=h.one(".next"))&&(o.one("a").setAttribute("href",i.collection.fullUrl+"?page="+(r+1)),r===a-1&&o&&o.remove()),1==h.all(".pagination-item").size()&&h.remove()):console.log("No need to remove last page.")},err:function(e){console.log(e)}}})}else console.log("No need to build pagination.")}(e):console.log("Pagination has no data to build.")})}),d(n,"paginationStylesPlugin"),function(e){try{var n=Static&&Static.SQUARESPACE_CONTEXT,t={pluginName:"Numbered Pagination",pluginPage:n&&n.website.baseUrl?n.website.baseUrl+location.pathname:location.href,pageTitle:document.title,pluginData:e||"No plugin data",siteTitle:n&&n.website.siteTitle||"",siteUrl:n&&n.website.baseUrl||location.origin},o=new XMLHttpRequest;o.open("POST","https://tools.squarewebsites.org/api/sqs-plugins",!0),o.setRequestHeader("Content-Type","application/json;charset=UTF-8"),o.send(JSON.stringify(t))}catch(e){console.log(e)}}("Container: "+e))}function P(e){var n="";return e&&(e.category&&(n+="&category="+e.category),e.tag&&(n+="&tag="+e.tag),e.month&&(n+="&month="+e.month)),"&"==n[0]&&(n=n.replace("&","?")),n}if(window.__paginationPlugin)console.log("Seems Pagination already running");else try{window.__paginationPlugin=!0,window.Y?o():document.addEventListener("DOMContentLoaded",function e(){document.removeEventListener("DOMContentLoaded",e,!1),setTimeout(function(){o()},16)},!1)}catch(e){console.log(e)}function o(){window.Y&&window.Squarespace.onInitialize(Y,function(){if(window.paginationPluginConfig||(window.paginationPluginConfig={containers:{".blog-list,.BlogList,.collection-type-blog .main-content":{}}}),window.paginationPluginConfig&&window.paginationPluginConfig.containers)for(var e in window.paginationPluginConfig.containers)window.paginationPluginConfig.containers.hasOwnProperty(e)&&window.paginationPluginConfig.containers[e]&&t(e,window.paginationPluginConfig.containers[e])})}}();